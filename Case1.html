<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="about us, Mission and Goals">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Case1</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Case1.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 3.29.1, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i">
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": ""
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Case1">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-white u-header" id="sec-03d4"><div class="u-clearfix u-sheet u-sheet-1">
        <nav class="u-align-center u-menu u-menu-dropdown u-offcanvas u-menu-1" data-position="">
          <div class="menu-collapse" style="font-size: 1.875rem; letter-spacing: 0px; font-weight: 700; text-transform: uppercase;">
            <a class="u-button-style u-custom-active-border-color u-custom-active-color u-custom-border u-custom-border-color u-custom-borders u-custom-hover-border-color u-custom-hover-color u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-decoration u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-spacing-30 u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-border-2 u-border-active-palette-1-base u-border-hover-palette-1-light-1 u-border-no-left u-border-no-right u-border-no-top u-button-style u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90" href="Case1.html" style="padding: 10px 0px;">Case1</a>
</li><li class="u-nav-item"><a class="u-border-2 u-border-active-palette-1-base u-border-hover-palette-1-light-1 u-border-no-left u-border-no-right u-border-no-top u-button-style u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90" href="Case2.html" style="padding: 10px 0px;">Case2</a>
</li><li class="u-nav-item"><a class="u-border-2 u-border-active-palette-1-base u-border-hover-palette-1-light-1 u-border-no-left u-border-no-right u-border-no-top u-button-style u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90" href="https://chrislim1234.github.io/" target="_blank" style="padding: 10px 0px;">Back</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Case1.html" style="padding: 10px 0px;">Case1</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Case2.html" style="padding: 10px 0px;">Case2</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://chrislim1234.github.io/" target="_blank" style="padding: 10px 0px;">Back</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="carousel_052d">
      <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
        <div class="u-layout">
          <div class="u-layout-row">
            <div class="u-align-justify u-container-style u-grey-15 u-layout-cell u-size-49 u-layout-cell-1">
              <div class="u-container-layout u-container-layout-1">
                <img class="u-image u-image-default u-image-1" src="images/ScreenShot2021-11-01at1.14.42PM.png" alt="" data-image-width="854" data-image-height="1442">
                <h3 class="u-custom-font u-text u-text-font u-text-1">Case Study #1</h3>
                <p class="u-text u-text-2">Once we open the loans full schema csv we can see that it has 55 columns corresponding to each loanee and 10,000 entries in total. Despite each entry not having a value for each of the 55 columns, most of the columns have 10,000 entries with a select few columns such as debt_to_income_joint andmonths_since_90d_late<br>Introduction to case study and describe the dataset and any issues with it. The image on the right shows the different columns and their respective non-null count and dtyope
                </p>
              </div>
            </div>
            <div class="u-align-right u-container-style u-layout-cell u-size-11 u-layout-cell-2">
              <div class="u-container-layout u-valign-top u-container-layout-2">
                <div class="u-palette-3-base u-shape u-shape-rectangle u-shape-1"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-2" id="carousel_20db">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <h6 class="u-align-justify u-custom-font u-text u-text-font u-text-palette-3-base u-text-1">Loan Purpose</h6>
                  <p class="u-align-left u-custom-font u-font-montserrat u-text u-text-2">The first attribute I looked at was loan purpose as this stood out to me as I wanted to see why these users were even taking a loan to start with. As expected majority of loanees were doing it out of debt consoldiation or credit card debt. This is interesting as the risk for a business based loan versus a debt/credit card based loan is very different and we may very well have to separate the data based on loan purpose</p>
                  <img class="u-image u-image-default u-image-1" src="images/pie1.png" alt="" data-image-width="1600" data-image-height="1319">
                </div>
              </div>
              <div class="u-align-left u-container-style u-layout-cell u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <img class="u-image u-image-default u-image-2" src="images/scatter.png" alt="" data-image-width="7173" data-image-height="3879">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-3">Loan Grades</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-4">As can be seen from the graph above, unlike annual income and many other factors, interest rate is highly dependent on the grade of the loan. This makes sense as the grade given to the loan is&nbsp;based on factors such as borrower's credit history, quality of the collateral, and the likelihood of repayment of the principal and interest. As the interest rate is also based on similar factors, it makes sense that there is a connection between grade and interest rate. By looking at info given by the Lending Club it is clear that every grade has a base interest rate and the subgrade given represents the adjustment for risk and volatility which gets added to the base Interest Rate. This information will be especially useful when we predict interest rates in the next part.&nbsp;<br>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-3" id="carousel_af75">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-left u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                <div class="u-container-layout u-valign-top-sm u-valign-top-xs u-container-layout-1">
                  <img class="u-image u-image-default u-image-1" src="images/bar.png" alt="" data-image-width="4901" data-image-height="2513">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-1">State Information</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-2">Out of the 50 states, most of the loanees were from California with the next two being Texas and New York. This bar graph above makes total sense as the three states listed above are the three most populated states in the US. Hence from this graph, we can tell that states should not have any biases that would affect the data and that the generalized insights we get in the next part could be said to give a relatively accurate picture of a US loanee regardless of what state they are from.&nbsp;</p>
                </div>
              </div>
              <div class="u-align-left u-container-style u-layout-cell u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-3">Homeownership</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-4">From the box plots shown below we can see that the interest rates for loanees who have a mortgage, pay rent or own a place have quite different interest rates. Some interesting insights we can see include that all three box plots have a number of outliers highlighting those who have a potentially bad credit/debt record,&nbsp; have a similar range/standard deviation. In regards to the mean, those with mortgages had the lowest interest rate when compared to both renters and home-owners. In regards to skewness it seems that the interest rate distribution for those with mortgage's is approximately normal, while renters are skewed to the left, and homeowners skewed to the right.&nbsp;</p>
                  <img class="u-image u-image-default u-image-2" src="images/box.png" alt="" data-image-width="7173" data-image-height="3879">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-4" id="sec-2373">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-left u-container-style u-layout-cell u-size-21 u-layout-cell-1">
                <div class="u-container-layout u-valign-top-sm u-valign-top-xs u-container-layout-1">
                  <img class="u-image u-image-default u-image-1" src="images/displot.png" alt="" data-image-width="1868" data-image-height="1525">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-1">Application Type</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-2">As can be seen above, the database includes data from both individual and joint types. The number of individual applications here are significantly higher than that of joint applications and despite the joint applications distribution being more normally distributed, both joint and individual applications are around the same range and have similar distributions. With this in mind, we might not have to split the data by application type before working on the feature set as the distributions are similar and application type does not seem to directly affect the interest rate.&nbsp;</p>
                </div>
              </div>
              <div class="u-align-left u-container-style u-layout-cell u-size-39 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-3">Issue Months</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-4">The database includes data from the three different issue months â€” January, February and March 2018. From the graph at the bottom, we have split the data based on the issue month and shown graphs relating debt to income to interest rate. It doesn't seem like there is any relationship between debt to income to interest rate, or any significant changes to the data by filtering it by issue month. However by looking at the regression lines, we can tell that Debt to Income has a povite correlation with Interest Rate and we will keep this in mind as we work to find the factors that help us predict the interest rate. The similarities between the three graphs below also makes sense as interest rate should not change because of the issue month.&nbsp;</p>
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-5">Delinquencies</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-6">In the graph below, we have also created regression lines after filtering the data by whether the loanee has had any delinquencies. As can be seen for each issue month, the regression for those with previous delinquencies has a higher constant but similar slopes. This means that delinquencies have a possible affect on interest rate as a higher constant of the regression line signifies that those with delinquencies have a higher interest rate for their loans.</p>
                  <img class="u-image u-image-default u-image-2" src="images/lmplot.png" alt="" data-image-width="1600" data-image-height="564">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-a5d4">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-left u-container-style u-layout-cell u-size-60 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-1"> Interest Rate Predictions</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-2"> In this part, I will be showing two different algorithms that attempt to predict the interest rate based on a data input from the database provided. First of all, I would like to describe some of the insights I have gained from the previous exploratory data analytics. First of all, we have seen that grade and subgrade have a direct effect on the interest rate with the interest rate on the loan offered being given to the loanee based on the grade they have been given. Moreover, if we look at the Lending Club website we see that the interest rate for a loanee is directly based on the sub-grade with the interest rate being equal to the base IR (given based on what grade) plus the adjustment for risk and volatility (given based on the sub grade). Second of all, we can see from the other graphs above, many of the categorical information such as state has too many unique values and would definitely overload any model we decide to use. &nbsp;Hence, we would need to select which factors to use in the model and this means we would need feature importance analysis for both numerical and categorical values.</p>
                  <h6 class="u-custom-font u-text u-text-font u-text-palette-3-base u-text-3">Data Cleaning and Feature Importance</h6>
                  <p class="u-custom-font u-font-montserrat u-text u-text-4">The first step I did was to get rid of all of the columns that had a huge number of null values, as using these factors to do our modelling would create incosistencies due to the lack of information for that factor and we would be overfitting by forcing the model to use data from that factor. The second step was to deal with the columns that had a small number of null values and for numerical columns I dealt with this by finding the mean of the column data and placing that into all entries with null values for that column. For categorical columns, this was more challenging and due to the time constraint I had to leave those columns out of the data model. The third step was to deal with the valid categorical column that had a entry for each row, and for this part I used pandas get_dummies function to turn each categorical column into a numerical column by splitting a column with n unique values into n columns with the entry having 1 in that column if it had that unique value and 0 if it did not. Last but not least, I had to do some basic feature importance analysis to be able to see which factors we would use in the model. Due to the categorical columns giving me inf or nan for the feature importance score, I only looked at numerical columns for the feature importance analysis I have shown below.&nbsp; As seen below, the analysis showed that the three most important features were paid interest, public record bankrupt and account opened 24m.&nbsp;</p>
                  <img class="u-image u-image-default u-image-1" src="images/ScreenShot2021-11-01at11.49.56PM.png" alt="" data-image-width="2576" data-image-height="876">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-6" id="carousel_9be1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-gutter-84 u-layout-wrap u-layout-wrap-1">
          <div class="u-gutter-0 u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-60 u-white u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <h2 class="u-align-center u-text u-text-1">Algorithm 1: Gradient Boosting Regressor</h2>
                  <p class="u-align-center u-text u-text-2">The first algorithm I used was a boosting method called gradient boosting regressor. This algorithm made use of one major assumption and it was that other than the factors included in the model all other factors have no impact on the interest rate. However, I only chose factors that were shown to have high importance either in the feature importance study or through EDA analysis that I have also included above. These factors included grade, sub grade, paid interest and public record bankrupt.&nbsp;</p>
                  <p class="u-align-center u-text u-text-3">The first step I did was split the data into training and testing data before implementing sckit learn's gradient boosting regressor algorithm. After fitting the data, I compared the predicted y with the test y after placing the test x into the model. At the end I calculated the mean square error and graphed the test data and how far they were from the predicted values.&nbsp;</p>
                  <p class="u-align-center u-text u-text-4"><b>Mean Square Error: 0.05&nbsp;</b>
                  </p>
                  <img class="u-image u-image-default u-image-1" src="images/ScreenShot2021-11-02at12.02.39AM.png" alt="" data-image-width="1600" data-image-height="1052">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-b814">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-gutter-84 u-layout-wrap u-layout-wrap-1">
          <div class="u-gutter-0 u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-60 u-white u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <h2 class="u-align-center u-text u-text-1">Algorithm 2: CatBoost Regression</h2>
                  <p class="u-align-center u-text u-text-2">The second algorithm I used was a decision tree based method called CatBoost. This algorithm made use of one major assumption and it was that all factors have an effect on the interest rate despite this definitely not being true. One change that I made was that instead of including all factors I excluded categorical factors that had null values as I did not know what to do with them especially since Catboost takes in categorical and numerical values separately. These factors I have excluded include&nbsp;
verification_income_joint, annual_income_joint,state,verified_income.&nbsp;</p>
                  <p class="u-align-center u-text u-text-3">The first step I did was split the data into training and testing data before implementing catboost's regression algorithm. Since catboost automatically improves its own model over its iterations, I made catboost run 50 iterations with the learning rate set to 0.434419. At the end, catboost found that the best RMSE after 50 iterations was 0.4958292269 which is really good considering how many factors we included (almost all especially compared to the gradient boosting regressor which only used 4).</p>
                  <p class="u-align-center u-text u-text-4"><b>Root Mean Square Error: 0.4958292269&nbsp;</b>
                  </p>
                  <img class="u-image u-image-default u-image-1" src="images/ScreenShot2021-11-02at1.06.43AM.png" alt="" data-image-width="1510" data-image-height="942">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-8" id="sec-3b0c">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-gutter-84 u-layout-wrap u-layout-wrap-1">
          <div class="u-gutter-0 u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-60 u-white u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <h2 class="u-align-center u-text u-text-1">Model and Enhancements</h2>
                  <p class="u-align-center u-text u-text-2">Now that we have two different algorithms that are relatively accurate, we can combine them by averaging the predicted value of the two algorithms for each y value.&nbsp; We have used two regression models one in which we have chosen which factors to use and one that used all the factors provided. By dividing the two, we have attempted to eliminate some of the potential errors we made due to assumptions made about what factors to include. I would personally have liked to make enhancements to both algorithms if I had more time to work on this project. First of all, it is evident that the gradient boosting regressor could have possibly had a better combination of factors that could have decreased the MSE even more. I was just putting in factors based on logic and the EDA before this part and I wish I could have wrote an algorithm that would look through all combinations of the factors and found the one with the lowest MSE. In regards to the Catboost algorithm I wish I had time to find a way to not leave out the categorical factors that had some null values, maybe I could have added 0 to all values to the categorical dummy factors. Additionally, I could have tested Catboost with less factors and maybe using only a couple factors like I had done for the gradient boosting regressor would have found more accurate results.&nbsp;</p>
                  <p class="u-align-center u-text u-text-3">Some issues that I would have liked to work on outside of the two algorithms I had used was that both algorithms were regressions because the target was a numerical variable and I was not able to use logistic algorithms or other non-continuous algorithms that may have given us better results. One idea I have is that we could have separated the data based on sub-grade and grade first and then had indiviudal models based on the other factors. This would have given us very good results as we know from foresight that the Lending Club gives loanees interest rates based on the grade they are given. Maybe we could even figure out what factors had a direct affect on the grade instead of the interest rate. However all in all, I think the two algorithms combine well and work together to decrease error and this is evident with the low MSE and RMSE that the two algorithms gave.&nbsp;<br>
                    <br>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-d219"><div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Chris Lim&nbsp;<br>Email: chrislim@usc.edu<br>Phone Number: (213)-374-5857
        </p>
      </div></footer>
  </body>
</html>
